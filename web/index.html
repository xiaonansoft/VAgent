<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>提钒冶炼智能体原型</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  </head>
  <body>
    <div class="app">
      <header class="header">
        <div class="header-left">
          <div class="title">提钒冶炼智能体（原型）</div>
          <div class="sub">Copilot + Monitor + Skills 控制台</div>
        </div>
        <div class="header-right">
          <div id="healthPill" class="pill muted">后端：检测中</div>
          <div id="streamPill" class="pill muted">数据流：未连接</div>
        </div>
      </header>

      <main class="grid">
        <section class="panel">
          <div class="panel-title">Copilot（开吹前配料）</div>
          <div class="form">
            <label>
              铁水温度(℃)
              <input id="ironTemp" type="number" step="0.1" placeholder="例如 1340" />
            </label>
            <label>
              Si(%) 
              <input id="siContent" type="number" step="0.001" placeholder="例如 0.28" />
            </label>
            <label class="checkbox">
              <input id="isOneCan" type="checkbox" />
              一罐到底
            </label>
            <div class="inline-row">
              <button id="useLiveTempBtn" class="btn secondary" type="button">使用实时温度</button>
              <div id="liveTempHint" class="hint">当前：-</div>
            </div>
          </div>

          <div class="chat">
            <div id="chatLog" class="chat-log"></div>
            <div class="chat-input">
              <textarea id="chatMessage" rows="3" placeholder="例如：这炉铁水硅有点高，怎么配？（Ctrl/⌘ + Enter 发送）"></textarea>
              <button id="sendBtn" class="btn primary" type="button">发送</button>
            </div>
            <div class="chips">
              <button class="chip" type="button" data-prompt="这炉铁水硅 0.28，一罐到底，怎么配？">高硅配料</button>
              <button class="chip" type="button" data-prompt="枪位怎么走？Si=0.18">枪位策略</button>
              <button class="chip" type="button" data-prompt="为什么这炉钒低？请诊断">钒低诊断</button>
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="panel-title">Monitor（过程监控）</div>
          <div class="hint" id="monitorHint">最近更新：-</div>
          <div class="kpis">
            <div class="kpi">
              <div class="kpi-label">当前温度</div>
              <div id="kpiTemp" class="kpi-value">-</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">临界温度</div>
              <div id="kpiCritical" class="kpi-value">1361.0℃</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">裕度(T-Tc)</div>
              <div id="kpiMargin" class="kpi-value">-</div>
            </div>
          </div>

          <div id="chart" class="chart"></div>

          <div class="alerts">
            <div class="panel-title">告警</div>
            <div id="alertBox" class="alert-box muted">暂无告警</div>
          </div>
        </section>

        <section class="panel span-2">
          <div class="panel-title">Skills 控制台（直接调用 MCP Tools）</div>
          <div class="tools-grid">
            <div class="tools-left">
              <div class="tool-row">
                <label class="tool-label">
                  工具
                  <select id="toolSelect"></select>
                </label>
                <button id="refreshToolsBtn" class="btn secondary" type="button">刷新列表</button>
                <button id="callToolBtn" class="btn primary" type="button">调用</button>
              </div>
              <label>
                arguments (JSON)
                <textarea id="toolArgs" rows="8" placeholder='{"si_content_pct":0.28}'></textarea>
              </label>
            </div>
            <div class="tools-right">
              <div class="hint">返回结果</div>
              <pre id="toolOutput" class="code">-</pre>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
